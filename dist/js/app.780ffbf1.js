(function(){"use strict";var e={3822:function(e,t,o){var r=o(5130),a=o(6768);const s={class:"content"};function n(e,t,o,r,n,i){const c=(0,a.g2)("MainNavbar"),l=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(c),(0,a.Lk)("div",s,[(0,a.bF)(l)])],64)}const i={class:"navbar"},c={class:"nav-links"};function l(e,t,o,r,s,n){const l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("nav",i,[(0,a.bF)(l,{to:"/",class:"nav-logo"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("МедСистема")]))),_:1}),(0,a.Lk)("div",c,[(0,a.bF)(l,{to:"/"},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("Главная")]))),_:1}),n.isAuthenticated?((0,a.uX)(),(0,a.Wv)(l,{key:0,to:"/appointment",class:"nav-link"},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("Запись к врачу")]))),_:1})):(0,a.Q3)("",!0),n.isAuthenticated?((0,a.uX)(),(0,a.Wv)(l,{key:1,to:"/appointmentList"},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("Ваши записи")]))),_:1})):(0,a.Q3)("",!0),n.isAuthenticated?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(l,{key:2,to:"/login"},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)("Войти")]))),_:1})),n.isAuthenticated?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(l,{key:3,to:"/register"},{default:(0,a.k6)((()=>t[6]||(t[6]=[(0,a.eW)("Регистрация")]))),_:1})),n.isAuthenticated?((0,a.uX)(),(0,a.Wv)(l,{key:4,to:"/profile"},{default:(0,a.k6)((()=>t[7]||(t[7]=[(0,a.eW)("Профиль")]))),_:1})):(0,a.Q3)("",!0),n.isAuthenticated?((0,a.uX)(),(0,a.CE)("button",{key:5,onClick:t[0]||(t[0]=(...e)=>n.logout&&n.logout(...e)),class:"btn-logout"},"Выход")):(0,a.Q3)("",!0)])])}o(4114);var d={name:"MainNavbar",computed:{isAuthenticated(){return!!localStorage.getItem("token")}},methods:{logout(){localStorage.removeItem("token"),localStorage.removeItem("role"),this.$router.push({name:"Home"}).then((()=>{window.location.reload()}))}}},u=o(1241);const p=(0,u.A)(d,[["render",l],["__scopeId","data-v-03e2ccaa"]]);var m=p,h={name:"App",components:{MainNavbar:m}};const k=(0,u.A)(h,[["render",n]]);var g=k,v=o(1387),f=o(4232);const y={class:"form-container"},L={key:0,class:"error"};function b(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",y,[t[8]||(t[8]=(0,a.Lk)("h2",null,"Регистрация",-1)),(0,a.Lk)("form",{onSubmit:t[6]||(t[6]=(0,r.D$)(((...e)=>i.handleRegister&&i.handleRegister(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.firstName=e),type:"text",placeholder:"Имя",required:""},null,512),[[r.Jo,n.firstName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.lastName=e),type:"text",placeholder:"Фамилия",required:""},null,512),[[r.Jo,n.lastName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.age=e),type:"number",placeholder:"Возраст",required:""},null,512),[[r.Jo,n.age]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.email=e),type:"email",placeholder:"Email",required:""},null,512),[[r.Jo,n.email]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>n.password=e),type:"password",placeholder:"Пароль",required:""},null,512),[[r.Jo,n.password]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>n.confirmPassword=e),type:"password",placeholder:"Подтвердите пароль",required:""},null,512),[[r.Jo,n.confirmPassword]]),t[7]||(t[7]=(0,a.Lk)("button",{type:"submit"},"Зарегистрироваться",-1)),n.error?((0,a.uX)(),(0,a.CE)("p",L,(0,f.v_)(n.error),1)):(0,a.Q3)("",!0)],32)])}var w=o(4373),C={name:"UserRegisterPage",data(){return{firstName:"",lastName:"",age:"",email:"",password:"",confirmPassword:"",error:""}},methods:{async handleRegister(){if(this.password===this.confirmPassword)try{await w.A.post("https://clinic-system-amwk.onrender.com/auth/register/user",{firstName:this.firstName,lastName:this.lastName,age:Number(this.age),email:this.email,password:this.password,isManager:!1}),this.$router.push("/login")}catch(e){this.error=e.response?.data?.message||"Ошибка регистрации"}else this.error="Пароли не совпадают"}}};const _=(0,u.A)(C,[["render",b],["__scopeId","data-v-5ab627b1"]]);var A=_;const E={class:"form-container"},X={key:0,class:"error"};function I(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",E,[t[4]||(t[4]=(0,a.Lk)("h2",null,"Вход",-1)),(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)(((...e)=>i.handleLogin&&i.handleLogin(...e)),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.email=e),type:"email",placeholder:"Email",required:""},null,512),[[r.Jo,n.email]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.password=e),type:"password",placeholder:"Пароль",required:""},null,512),[[r.Jo,n.password]]),t[3]||(t[3]=(0,a.Lk)("button",{type:"submit"},"Войти",-1)),n.error?((0,a.uX)(),(0,a.CE)("p",X,(0,f.v_)(n.error),1)):(0,a.Q3)("",!0)],32)])}var S={name:"UserLoginPage",data(){return{email:"",password:"",error:""}},methods:{async handleLogin(){try{const e=await w.A.post("https://clinic-system-amwk.onrender.com/auth/login",{email:this.email,password:this.password});localStorage.setItem("token",e.data.token),localStorage.setItem("role",e.data.role||""),this.$router.push({name:"Home"}).then((()=>{window.location.reload()}))}catch(e){console.error("Ошибка логина:",e.response),this.error=e.response?.data?.message||"Ошибка входа"}}}};const D=(0,u.A)(S,[["render",I],["__scopeId","data-v-f3e00940"]]);var $=D;const W={class:"doctor-profile"},M={key:0},U={key:0,class:"appointments"},P={key:1};function z(e,t,o,r,s,n){return(0,a.uX)(),(0,a.CE)("div",W,[t[6]||(t[6]=(0,a.Lk)("h1",null,"Профиль врача",-1)),s.doctor?((0,a.uX)(),(0,a.CE)("div",M,[(0,a.Lk)("p",null,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Имя:",-1)),(0,a.eW)(" "+(0,f.v_)(s.doctor.doctorName),1)]),(0,a.Lk)("p",null,[t[1]||(t[1]=(0,a.Lk)("strong",null,"Email:",-1)),(0,a.eW)(" "+(0,f.v_)(s.doctor.email),1)]),(0,a.Lk)("p",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Специализация:",-1)),(0,a.eW)(" "+(0,f.v_)(s.doctor.speciality.speciality),1)]),(0,a.Lk)("p",null,[t[3]||(t[3]=(0,a.Lk)("strong",null,"Стаж:",-1)),(0,a.eW)(" "+(0,f.v_)(s.doctor.speciality.experience)+" лет",1)]),s.appointments.length?((0,a.uX)(),(0,a.CE)("div",U,[t[4]||(t[4]=(0,a.Lk)("h2",null,"Записи к вам",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.appointments,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id},(0,f.v_)(e.appointmentTime),1)))),128))])])):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",P,t[5]||(t[5]=[(0,a.Lk)("p",null,"Загрузка профиля врача...",-1)])))])}var F={name:"DoctorProfile",data(){return{doctor:null,appointments:[],error:""}},async created(){const e=localStorage.getItem("token"),t=localStorage.getItem("doctorId");try{const o=await w.A.get(`https://clinic-system-amwk.onrender.com/doctor/${t}`,{headers:{Authorization:`Bearer ${e}`}});this.doctor=o.data;const r=await w.A.get(`https://clinic-system-amwk.onrender.com/appointment/${t}`,{headers:{Authorization:`Bearer ${e}`}});this.appointments=r.data}catch(o){console.error("Ошибка загрузки профиля врача:",o),this.error=o.response?.data?.message||"Ошибка загрузки профиля"}}};const N=(0,u.A)(F,[["render",z],["__scopeId","data-v-ef6357ae"]]);var T=N;const B={class:"doctor-list"},x={class:"filter"},Q=["value"],V={key:0},q={key:1};function J(e,t,o,s,n,i){const c=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",B,[t[4]||(t[4]=(0,a.Lk)("h1",null,"Список врачей",-1)),(0,a.Lk)("div",x,[t[2]||(t[2]=(0,a.Lk)("label",{for:"spec-select"},"Фильтр по специализации:",-1)),(0,a.bo)((0,a.Lk)("select",{id:"spec-select","onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedSpec=e)},[t[1]||(t[1]=(0,a.Lk)("option",{value:""},"Все",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.specializations,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e,value:e},(0,f.v_)(e),9,Q)))),128))],512),[[r.u1,n.selectedSpec]])]),i.filteredDoctors.length?((0,a.uX)(),(0,a.CE)("ul",V,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.filteredDoctors,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id},[(0,a.Lk)("strong",null,(0,f.v_)(e.name),1),(0,a.eW)(" — "+(0,f.v_)(e.specialization)+" ",1),(0,a.bF)(c,{to:`/doctors/${e.id}`,class:"more-link"},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)(" Подробнее ")]))),_:2},1032,["to"])])))),128))])):((0,a.uX)(),(0,a.CE)("p",q,"Нет врачей для отображения."))])}o(8111),o(2489),o(1701),o(7642),o(8004),o(3853),o(5876),o(2475),o(5024),o(1698);var O={name:"DoctorsListPage",data(){return{doctors:[],selectedSpec:""}},computed:{specializations(){const e=this.doctors.map((e=>e.specialization));return Array.from(new Set(e))},filteredDoctors(){return this.selectedSpec?this.doctors.filter((e=>e.specialization===this.selectedSpec)):this.doctors}},async mounted(){try{const e=localStorage.getItem("token"),t=await w.A.get("https://clinic-system-amwk.onrender.com/doctor",{headers:{Authorization:`Bearer ${e}`}});this.doctors=t.data}catch(e){console.error("Ошибка загрузки врачей:",e)}}};const j=(0,u.A)(O,[["render",J],["__scopeId","data-v-5edcbb6e"]]);var R=j;function K(e,t,o,r,s,n){return(0,a.uX)(),(0,a.CE)("div",null,t[0]||(t[0]=[(0,a.Lk)("h1",null,"Files Page",-1)]))}var H={name:"FilesPage"};const G=(0,u.A)(H,[["render",K]]);var Y=G;const Z={key:0,class:"profile-container"},ee={class:"avatar-section"},te=["src"],oe={class:"upload-label"},re={key:1,class:"error"},ae={key:2,class:"loading"};function se(e,t,o,r,s,n){return(0,a.uX)(),(0,a.CE)("div",null,[s.user?((0,a.uX)(),(0,a.CE)("div",Z,[t[5]||(t[5]=(0,a.Lk)("h2",null,"Профиль пользователя",-1)),(0,a.Lk)("div",ee,[s.user.avatarUrl?((0,a.uX)(),(0,a.CE)("img",{key:0,src:s.user.avatarUrl,alt:"Аватар пользователя",class:"avatar"},null,8,te)):(0,a.Q3)("",!0),(0,a.Lk)("label",oe,[(0,a.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...e)=>n.onFileChange&&n.onFileChange(...e))},null,32),t[1]||(t[1]=(0,a.eW)(" Выбрать аватар "))])]),(0,a.Lk)("p",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Имя:",-1)),(0,a.eW)(" "+(0,f.v_)(s.user.firstName)+" "+(0,f.v_)(s.user.lastName),1)]),(0,a.Lk)("p",null,[t[3]||(t[3]=(0,a.Lk)("strong",null,"Email:",-1)),(0,a.eW)(" "+(0,f.v_)(s.user.email),1)]),(0,a.Lk)("p",null,[t[4]||(t[4]=(0,a.Lk)("strong",null,"Возраст:",-1)),(0,a.eW)(" "+(0,f.v_)(s.user.age),1)])])):s.error?((0,a.uX)(),(0,a.CE)("div",re,[(0,a.Lk)("p",null,(0,f.v_)(s.error),1)])):((0,a.uX)(),(0,a.CE)("div",ae,t[6]||(t[6]=[(0,a.Lk)("p",null,"Загрузка профиля...",-1)])))])}var ne={name:"UserProfilePage",data(){return{user:null,error:""}},async created(){await this.fetchUser()},methods:{async fetchUser(){try{const e=localStorage.getItem("token");if(!e)throw new Error("Пользователь не авторизован");const t=await w.A.get("https://clinic-system-amwk.onrender.com/user/me",{headers:{Authorization:`Bearer ${e}`}});this.user=t.data}catch(e){console.error("Ошибка при загрузке профиля:",e),this.error=e.response?.data?.message||e.message}},onFileChange(e){const t=e.target.files[0];t&&this.uploadAvatar(t)},async uploadAvatar(e){try{const t=localStorage.getItem("token"),o=new FormData;o.append("file",e),o.append("name","avatar");const r=await w.A.post("https://clinic-system-amwk.onrender.com/file",o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${t}`}});this.user.avatarUrl=r.data.fileUrl||r.data.url||r.data.publicUrl}catch(t){console.error("Ошибка при загрузке аватарки:",t),this.error="Не удалось загрузить аватарку"}}}};const ie=(0,u.A)(ne,[["render",se],["__scopeId","data-v-526eeac8"]]);var ce=ie;const le={class:"home"},de={class:"doctors-list"};function ue(e,t,o,r,s,n){const i=(0,a.g2)("DoctorCard");return(0,a.uX)(),(0,a.CE)("div",le,[t[0]||(t[0]=(0,a.Lk)("h1",null,"Наши врачи",-1)),(0,a.Lk)("div",de,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.doctors,(e=>((0,a.uX)(),(0,a.Wv)(i,{key:e._id||e.id,doctor:e},null,8,["doctor"])))),128))])])}const pe={class:"doctor-card"},me=["src"];function he(e,t,o,r,s,n){const i=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",pe,[(0,a.Lk)("img",{src:o.doctor.photo||s.defaultPhoto,alt:"Фото врача",class:"doctor-photo"},null,8,me),(0,a.Lk)("h3",null,(0,f.v_)(o.doctor.name),1),(0,a.Lk)("p",null,"Специализация: "+(0,f.v_)(o.doctor.specialization),1),(0,a.bF)(i,{to:`/doctors/${o.doctor.id}`,class:"btn"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)("Подробнее")]))),_:1},8,["to"])])}var ke={name:"DoctorCard",props:{doctor:{type:Object,required:!0}},data(){return{defaultPhoto:"/img/default.jpg"}}};const ge=(0,u.A)(ke,[["render",he],["__scopeId","data-v-24a7b8c6"]]);var ve=ge,fe={name:"HomePage",components:{DoctorCard:ve},data(){return{doctors:[]}},created(){this.fetchDoctors()},methods:{async fetchDoctors(){try{const e=await fetch("https://clinic-system-amwk.onrender.com/doctor");this.doctors=await e.json()}catch(e){console.error("Ошибка при загрузке списка врачей:",e)}}}};const ye=(0,u.A)(fe,[["render",ue],["__scopeId","data-v-27f792de"]]);var Le=ye;const be={class:"not-found"};function we(e,t,o,r,s,n){const i=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",be,[t[1]||(t[1]=(0,a.Lk)("h1",null,"404 - Страница не найдена",-1)),t[2]||(t[2]=(0,a.Lk)("p",null,"Упс! Такой страницы не существует.",-1)),(0,a.bF)(i,{to:"/"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)("Вернуться на главную")]))),_:1})])}var Ce={name:"NotFoundPage"};const _e=(0,u.A)(Ce,[["render",we],["__scopeId","data-v-688e76c0"]]);var Ae=_e;const Ee={class:"doctor-details"},Xe={key:0},Ie={key:1};function Se(e,t,o,r,s,n){return(0,a.uX)(),(0,a.CE)("div",Ee,[t[5]||(t[5]=(0,a.Lk)("h1",null,"Профиль врача",-1)),s.doctor?((0,a.uX)(),(0,a.CE)("div",Xe,[(0,a.Lk)("p",null,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Имя:",-1)),(0,a.eW)(" "+(0,f.v_)(s.doctor.doctorName),1)]),(0,a.Lk)("p",null,[t[1]||(t[1]=(0,a.Lk)("strong",null,"Email:",-1)),(0,a.eW)(" "+(0,f.v_)(s.doctor.email),1)]),(0,a.Lk)("p",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Специализация:",-1)),(0,a.eW)(" "+(0,f.v_)(s.doctor.speciality.speciality),1)]),(0,a.Lk)("p",null,[t[3]||(t[3]=(0,a.Lk)("strong",null,"Стаж:",-1)),(0,a.eW)(" "+(0,f.v_)(s.doctor.speciality.experience)+" лет",1)])])):((0,a.uX)(),(0,a.CE)("div",Ie,t[4]||(t[4]=[(0,a.Lk)("p",null,"Загрузка профиля врача...",-1)])))])}var De={name:"DoctorDetails",data(){return{doctor:null,error:""}},async created(){const e=this.$route.params.id,t=localStorage.getItem("token");try{const o=await w.A.get(`https://clinic-system-amwk.onrender.com/doctor/${e}`,{headers:{Authorization:`Bearer ${t}`}});this.doctor=o.data}catch(o){console.error("Ошибка загрузки деталей врача:",o),this.error=o.response?.data?.message||"Ошибка загрузки профиля врача"}}};const $e=(0,u.A)(De,[["render",Se],["__scopeId","data-v-2d747ef4"]]);var We=$e;const Me={class:"manager-settings"},Ue={class:"tabs"},Pe={class:"tab-content"},ze={key:0},Fe={key:0},Ne=["onClick"],Te={key:1},Be={key:1},xe={key:0},Qe=["onClick"],Ve={key:1};function qe(e,t,o,r,s,n){return(0,a.uX)(),(0,a.CE)("div",Me,[t[5]||(t[5]=(0,a.Lk)("h1",null,"Панель менеджера",-1)),(0,a.Lk)("div",Ue,[(0,a.Lk)("button",{class:(0,f.C4)({active:"users"===s.activeTab}),onClick:t[0]||(t[0]=e=>s.activeTab="users")},"Пользователи",2),(0,a.Lk)("button",{class:(0,f.C4)({active:"doctors"===s.activeTab}),onClick:t[1]||(t[1]=e=>s.activeTab="doctors")},"Врачи",2)]),(0,a.Lk)("div",Pe,["users"===s.activeTab?((0,a.uX)(),(0,a.CE)("div",ze,[t[3]||(t[3]=(0,a.Lk)("h2",null,"Управление пользователями",-1)),s.users.length?((0,a.uX)(),(0,a.CE)("ul",Fe,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.users,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id},[(0,a.eW)((0,f.v_)(e.firstName)+" "+(0,f.v_)(e.lastName)+" ("+(0,f.v_)(e.email)+") ",1),(0,a.Lk)("button",{onClick:t=>n.deleteUser(e.id)},"Удалить",8,Ne)])))),128))])):((0,a.uX)(),(0,a.CE)("p",Te,"Пользователи не найдены."))])):(0,a.Q3)("",!0),"doctors"===s.activeTab?((0,a.uX)(),(0,a.CE)("div",Be,[t[4]||(t[4]=(0,a.Lk)("h2",null,"Управление врачами",-1)),(0,a.Lk)("button",{class:"btn-add",onClick:t[2]||(t[2]=(...e)=>n.goToRegister&&n.goToRegister(...e))}," Добавить врача "),s.doctors.length?((0,a.uX)(),(0,a.CE)("ul",xe,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.doctors,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id},[(0,a.eW)(" Dr. "+(0,f.v_)(e.name)+" — "+(0,f.v_)(e.specialization)+" ",1),(0,a.Lk)("button",{onClick:t=>n.deleteDoctor(e.id)},"Удалить",8,Qe)])))),128))])):((0,a.uX)(),(0,a.CE)("p",Ve,"Врачи не найдены."))])):(0,a.Q3)("",!0)])])}var Je={name:"ManagerSettings",data(){return{activeTab:"users",users:[],doctors:[],error:""}},async created(){await this.fetchUsers(),await this.fetchDoctors()},methods:{goToRegister(){this.$router.push({name:"ManagerRegisterDoctors"})},async fetchUsers(){try{const e=localStorage.getItem("token"),t=await w.A.get("https://clinic-system-amwk.onrender.com/user",{headers:{Authorization:`Bearer ${e}`}});this.users=t.data}catch(e){console.error("Ошибка загрузки пользователей:",e),this.error="Не удалось загрузить пользователей"}},async deleteUser(e){if(confirm("Удалить этого пользователя?"))try{const t=localStorage.getItem("token");await w.A.delete(`https://clinic-system-amwk.onrender.com/user/${e}`,{headers:{Authorization:`Bearer ${t}`}}),this.users=this.users.filter((t=>t.id!==e))}catch(t){console.error("Ошибка удаления пользователя:",t),alert("Не удалось удалить пользователя")}},async fetchDoctors(){try{const e=localStorage.getItem("token"),t=await w.A.get("https://clinic-system-amwk.onrender.com/doctor",{headers:{Authorization:`Bearer ${e}`}});this.doctors=t.data}catch(e){console.error("Ошибка загрузки врачей:",e),this.error="Не удалось загрузить врачей"}},async deleteDoctor(e){if(confirm("Удалить этого врача?"))try{const t=localStorage.getItem("token");await w.A.delete(`https://clinic-system-amwk.onrender.com/doctor/${e}`,{headers:{Authorization:`Bearer ${t}`}}),this.doctors=this.doctors.filter((t=>t.id!==e))}catch(t){console.error("Ошибка удаления врача:",t),alert("Не удалось удалить врача")}}}};const Oe=(0,u.A)(Je,[["render",qe],["__scopeId","data-v-10b491a3"]]);var je=Oe;const Re={class:"appointment-page"},Ke={key:0,class:"not-auth"},He={key:1},Ge={class:"filter"},Ye=["value"],Ze={class:"doctors-list"},et=["onClick"],tt={class:"modal-section"};function ot(e,t,o,s,n,i){const c=(0,a.g2)("router-link"),l=(0,a.g2)("DoctorCard"),d=(0,a.g2)("Modal");return(0,a.uX)(),(0,a.CE)("div",Re,[t[9]||(t[9]=(0,a.Lk)("h1",null,"Запись к врачу",-1)),n.isAuthenticated?((0,a.uX)(),(0,a.CE)("div",He,[(0,a.Lk)("div",Ge,[t[7]||(t[7]=(0,a.Lk)("label",{for:"spec"},"Специализация:",-1)),(0,a.bo)((0,a.Lk)("select",{id:"spec","onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedSpec=e)},[t[6]||(t[6]=(0,a.Lk)("option",{value:""},"Все",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.specializations,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e,value:e},(0,f.v_)(e),9,Ye)))),128))],512),[[r.u1,n.selectedSpec]])]),(0,a.Lk)("div",Ze,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.filteredDoctors,(e=>((0,a.uX)(),(0,a.CE)("div",{class:"doctor-item",key:e._id||e.id},[(0,a.bF)(l,{doctor:e},null,8,["doctor"]),(0,a.Lk)("button",{onClick:t=>i.goToBooking(e),class:"btn-book"}," Записаться ",8,et)])))),128))]),(0,a.Lk)("div",tt,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>n.showModal=!0),class:"btn-delete"}," Удалить запись "),n.showModal?((0,a.uX)(),(0,a.Wv)(d,{key:0,onClose:t[3]||(t[3]=e=>n.showModal=!1)},{default:(0,a.k6)((()=>[t[8]||(t[8]=(0,a.Lk)("h3",null,"Вы уверены, что хотите удалить запись?",-1)),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.confirmDelete&&i.confirmDelete(...e))},"Да, удалить")])),_:1})):(0,a.Q3)("",!0)])])):((0,a.uX)(),(0,a.CE)("div",Ke,[t[5]||(t[5]=(0,a.Lk)("p",null,"Пожалуйста, войдите, чтобы записаться на приём.",-1)),(0,a.bF)(c,{to:"/login",class:"btn-login"},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("Войти")]))),_:1})]))])}const rt={class:"modal-content"};function at(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",{class:"modal-overlay",onClick:t[1]||(t[1]=(0,r.D$)(((...e)=>i.close&&i.close(...e)),["self"]))},[(0,a.Lk)("div",rt,[(0,a.RG)(e.$slots,"default",{},void 0,!0),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.close&&i.close(...e)),class:"close-btn"},"Закрыть")])])}var st={name:"Modal",methods:{close(){this.$emit("close")}}};const nt=(0,u.A)(st,[["render",at],["__scopeId","data-v-5388c2a7"]]);var it=nt,ct={name:"AppointmentPage",components:{DoctorCard:ve,Modal:it},data(){return{isAuthenticated:!!localStorage.getItem("token"),doctors:[],selectedSpec:"",showModal:!1}},computed:{specializations(){const e=this.doctors.map((e=>e.specialization));return Array.from(new Set(e))},filteredDoctors(){return this.selectedSpec?this.doctors.filter((e=>e.specialization===this.selectedSpec)):this.doctors}},created(){this.isAuthenticated&&this.fetchDoctors()},methods:{async fetchDoctors(){try{const e=localStorage.getItem("token"),t=await w.A.get("https://clinic-system-amwk.onrender.com/doctor",{headers:{Authorization:`Bearer ${e}`}});this.doctors=t.data}catch(e){console.error("Ошибка при загрузке врачей:",e)}},goToBooking(e){this.$router.push({name:"AppointmentButton",params:{doctorId:e._id||e.id}})},confirmDelete(){this.showModal=!1}}};const lt=(0,u.A)(ct,[["render",ot],["__scopeId","data-v-524a9bc4"]]);var dt=lt;const ut={class:"appointment-book"},pt={key:0},mt={class:"form-group"},ht=["disabled"];function kt(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",ut,[t[4]||(t[4]=(0,a.Lk)("h1",null,"Запись к врачу",-1)),n.doctor?((0,a.uX)(),(0,a.CE)("div",pt,[(0,a.Lk)("p",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Врач:",-1)),(0,a.eW)(" "+(0,f.v_)(n.doctor.name)+" ("+(0,f.v_)(n.doctor.specialization)+")",1)])])):(0,a.Q3)("",!0),(0,a.Lk)("div",mt,[t[3]||(t[3]=(0,a.Lk)("label",{for:"datetime"},"Дата и время приёма:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"datetime",type:"datetime-local","onUpdate:modelValue":t[0]||(t[0]=e=>n.appointmentTime=e)},null,512),[[r.Jo,n.appointmentTime]])]),(0,a.Lk)("button",{class:"btn-submit",disabled:!n.appointmentTime,onClick:t[1]||(t[1]=(...e)=>i.submitAppointment&&i.submitAppointment(...e))}," Подтвердить запись ",8,ht),n.message?((0,a.uX)(),(0,a.CE)("p",{key:1,class:(0,f.C4)({success:n.success,error:!n.success})},(0,f.v_)(n.message),3)):(0,a.Q3)("",!0)])}var gt={name:"AppointmentButton",data(){return{doctor:null,appointmentTime:"",message:"",success:!1,user:null}},async created(){const e=localStorage.getItem("token"),t=this.$route.params.doctorId;try{const o=await w.A.get(`https://clinic-system-amwk.onrender.com/doctor/${t}`,{headers:{Authorization:`Bearer ${e}`}});this.doctor=o.data}catch(o){console.error("Ошибка загрузки врача:",o)}try{const t=await w.A.get("https://clinic-system-amwk.onrender.com/user/me",{headers:{Authorization:`Bearer ${e}`}});this.user=t.data,console.log("Получен пользователь:",this.user)}catch(o){console.error("Ошибка загрузки пользователя:",o),this.message=o.response?.data?.message||"Ошибка загрузки профиля"}},methods:{async submitAppointment(){if(!this.appointmentTime)return void(this.message="Укажите дату и время приёма");const e=localStorage.getItem("token");try{const t={appointmentTime:new Date(this.appointmentTime).toISOString(),doctorId:this.doctor._id||this.doctor.id,patientId:this.user?this.user._id||this.user.id:null};console.log("Отправляем payload:",t),await w.A.post("https://clinic-system-amwk.onrender.com/appointment",t,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),this.message="Запись успешно создана",this.success=!0}catch(t){console.error("Ошибка при записи:",t.response||t),this.message=t.response?.data?.message||"Не удалось записаться",this.success=!1}}}};const vt=(0,u.A)(gt,[["render",kt],["__scopeId","data-v-28af1ecc"]]);var ft=vt;const yt={class:"appointments-list"},Lt={key:0,class:"error"},bt={key:1},wt={key:0},Ct={key:1};function _t(e,t,o,r,s,n){return(0,a.uX)(),(0,a.CE)("div",yt,[t[2]||(t[2]=(0,a.Lk)("h1",null,"Ваши записи",-1)),s.error?((0,a.uX)(),(0,a.CE)("div",Lt,[(0,a.Lk)("p",null,(0,f.v_)(s.error),1)])):((0,a.uX)(),(0,a.CE)("div",bt,[s.appointments.length?((0,a.uX)(),(0,a.CE)("ul",wt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.appointments,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e._id||e.id},[(0,a.Lk)("p",null,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Дата и время:",-1)),(0,a.eW)(" "+(0,f.v_)(e.appointmentTime),1)]),(0,a.Lk)("p",null,[t[1]||(t[1]=(0,a.Lk)("strong",null,"ID врача:",-1)),(0,a.eW)(" "+(0,f.v_)(e.doctorId),1)])])))),128))])):((0,a.uX)(),(0,a.CE)("p",Ct,"Записи не найдены."))]))])}var At={name:"AppointmentsList",data(){return{appointments:[],error:""}},async created(){try{const e=localStorage.getItem("token");if(!e)throw new Error("Пользователь не авторизован");const t=localStorage.getItem("role"),o=localStorage.getItem("doctor"===t?"doctorId":"userId");if(!o)throw new Error("Не удалось определить идентификатор пользователя");let r="";r="doctor"===t?`https://clinic-system-amwk.onrender.com/appointment/doctor/${o}`:`https://clinic-system-amwk.onrender.com/appointment/patient/${o}`;const a=await w.A.get(r,{headers:{Authorization:`Bearer ${e}`}});this.appointments=a.data}catch(e){console.error("Ошибка загрузки записей:",e),this.error=e.response?.data?.message||e.message||"Ошибка загрузки записей"}}};const Et=(0,u.A)(At,[["render",_t],["__scopeId","data-v-03479fd7"]]);var Xt=Et;const It={class:"manager-register-doctors"},St={class:"form-group"},Dt={class:"form-group"},$t={class:"form-group"},Wt={class:"form-group"},Mt={class:"form-group"},Ut={class:"form-group"},Pt={key:0,class:"success"},zt={key:1,class:"error"};function Ft(e,t,o,s,n,i){return(0,a.uX)(),(0,a.CE)("div",It,[t[14]||(t[14]=(0,a.Lk)("h1",null,"Регистрация нового врача",-1)),(0,a.Lk)("form",{onSubmit:t[6]||(t[6]=(0,r.D$)(((...e)=>i.registerDoctor&&i.registerDoctor(...e)),["prevent"])),class:"register-form"},[(0,a.Lk)("div",St,[t[7]||(t[7]=(0,a.Lk)("label",{for:"name"},"Имя врача",-1)),(0,a.bo)((0,a.Lk)("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>n.doctorName=e),type:"text",placeholder:"string",required:""},null,512),[[r.Jo,n.doctorName]])]),(0,a.Lk)("div",Dt,[t[8]||(t[8]=(0,a.Lk)("label",{for:"email"},"Email",-1)),(0,a.bo)((0,a.Lk)("input",{id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>n.email=e),type:"email",placeholder:"example@mail.kz",required:""},null,512),[[r.Jo,n.email]])]),(0,a.Lk)("div",$t,[t[9]||(t[9]=(0,a.Lk)("label",{for:"password"},"Пароль",-1)),(0,a.bo)((0,a.Lk)("input",{id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>n.password=e),type:"password",placeholder:"string",required:""},null,512),[[r.Jo,n.password]])]),(0,a.Lk)("div",Wt,[t[10]||(t[10]=(0,a.Lk)("label",{for:"confirmPassword"},"Подтвердите пароль",-1)),(0,a.bo)((0,a.Lk)("input",{id:"confirmPassword","onUpdate:modelValue":t[3]||(t[3]=e=>n.confirmPassword=e),type:"password",placeholder:"string",required:""},null,512),[[r.Jo,n.confirmPassword]])]),(0,a.Lk)("div",Mt,[t[11]||(t[11]=(0,a.Lk)("label",{for:"speciality"},"Специализация",-1)),(0,a.bo)((0,a.Lk)("input",{id:"speciality","onUpdate:modelValue":t[4]||(t[4]=e=>n.speciality=e),type:"text",placeholder:"Кардиолог",required:""},null,512),[[r.Jo,n.speciality]])]),(0,a.Lk)("div",Ut,[t[12]||(t[12]=(0,a.Lk)("label",{for:"experience"},"Стаж (лет)",-1)),(0,a.bo)((0,a.Lk)("input",{id:"experience","onUpdate:modelValue":t[5]||(t[5]=e=>n.experience=e),type:"number",min:"0",placeholder:"10",required:""},null,512),[[r.Jo,n.experience,void 0,{number:!0}]])]),t[13]||(t[13]=(0,a.Lk)("button",{type:"submit",class:"btn-submit"},"Зарегистрировать",-1)),n.successMessage?((0,a.uX)(),(0,a.CE)("p",Pt,(0,f.v_)(n.successMessage),1)):(0,a.Q3)("",!0),n.errorMessage?((0,a.uX)(),(0,a.CE)("p",zt,(0,f.v_)(n.errorMessage),1)):(0,a.Q3)("",!0)],32)])}var Nt={name:"ManagerRegisterDoctors",data(){return{doctorName:"",email:"",password:"",confirmPassword:"",speciality:"",experience:null,successMessage:"",errorMessage:""}},methods:{async registerDoctor(){if(this.successMessage="",this.errorMessage="",this.password===this.confirmPassword)try{const e=localStorage.getItem("token"),t={doctorName:this.doctorName,email:this.email,password:this.password,speciality:{speciality:this.speciality,experience:this.experience}};await w.A.post("https://clinic-system-amwk.onrender.com/auth/register/doctor",t,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),this.successMessage="Врач успешно зарегистрирован",this.doctorName="",this.email="",this.password="",this.confirmPassword="",this.speciality="",this.experience=null}catch(e){console.error("Ошибка регистрации врача:",e),this.errorMessage=e.response?.data?.message||"Не удалось зарегистрировать врача"}else this.errorMessage="Пароли не совпадают"}}};const Tt=(0,u.A)(Nt,[["render",Ft],["__scopeId","data-v-92544a22"]]);var Bt=Tt;const xt=[{path:"/",name:"Home",component:Le},{path:"/register",name:"Register",component:A},{path:"/login",name:"Login",component:$},{path:"/doctors/:id",name:"DoctorDetails",component:We},{path:"/doctor-profile",name:"DoctorProfile",component:T},{path:"/doctors",name:"DoctorsList",component:R},{path:"/files",name:"Files",component:Y},{path:"/profile",name:"Profile",component:ce},{path:"/ManagerSettings",name:"Manager",component:je},{path:"/Appointment",name:"Appointment",component:dt},{path:"/AppointmentList",name:"AppointmentList",component:Xt},{path:"/AppointmentButton",name:"AppointmentButton",component:ft},{path:"/ManagerRegisterDoctors",name:"ManagerRegisterDoctors",component:Bt},{path:"/:pathMatch(.*)*",name:"NotFound",component:Ae}],Qt=(0,v.aE)({history:(0,v.LA)(),routes:xt});var Vt=Qt,qt=o(2261);const Jt=(0,r.Ef)(g);Jt.use(Vt),Jt.use((0,qt.Ey)()),Jt.mount("#app")}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,r,a,s){if(!r){var n=1/0;for(d=0;d<e.length;d++){r=e[d][0],a=e[d][1],s=e[d][2];for(var i=!0,c=0;c<r.length;c++)(!1&s||n>=s)&&Object.keys(o.O).every((function(e){return o.O[e](r[c])}))?r.splice(c--,1):(i=!1,s<n&&(n=s));if(i){e.splice(d--,1);var l=a();void 0!==l&&(t=l)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[r,a,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,s,n=r[0],i=r[1],c=r[2],l=0;if(n.some((function(t){return 0!==e[t]}))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(c)var d=c(o)}for(t&&t(r);l<n.length;l++)s=n[l],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(d)},r=self["webpackChunkclinic_frontend"]=self["webpackChunkclinic_frontend"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[504],(function(){return o(3822)}));r=o.O(r)})();
//# sourceMappingURL=app.780ffbf1.js.map